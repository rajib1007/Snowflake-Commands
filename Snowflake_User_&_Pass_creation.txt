CREATE OR REPLACE WAREHOUSE DEMO_WH
  WAREHOUSE_SIZE = 'XSMALL'
  AUTO_SUSPEND = 60
  AUTO_RESUME = TRUE
  INITIALLY_SUSPENDED = TRUE;
USE WAREHOUSE DEMO_WH;
-- 2. Create Database and Schema
CREATE OR REPLACE DATABASE GLUE_SNOWFLAKE_CONNECTOR_DB;
CREATE OR REPLACE SCHEMA  GLUE_SNOWFLAKE_CONNECTOR_DB.RAW;


-- 3. Create Role
CREATE OR REPLACE ROLE GLUE_SNOWFLAKE_CONNECTOR_ROLE;
-- 4. Create User
CREATE OR REPLACE USER GLUE_SNOWFLAKE_CONNECTOR_USER
  PASSWORD = 'Rajib@9231507910'
  DEFAULT_ROLE = GLUE_SNOWFLAKE_CONNECTOR_ROLE
  DEFAULT_WAREHOUSE = DEMO_WH
  DEFAULT_NAMESPACE =   GLUE_SNOWFLAKE_CONNECTOR_DB.RAW;
-- 5. Assign Role to User
GRANT ROLE GLUE_SNOWFLAKE_CONNECTOR_ROLE TO USER GLUE_SNOWFLAKE_CONNECTOR_USER;
-- 6. Grant Access Privileges
GRANT USAGE ON DATABASE GLUE_SNOWFLAKE_CONNECTOR_DB TO ROLE GLUE_SNOWFLAKE_CONNECTOR_ROLE;
GRANT USAGE ON SCHEMA GLUE_SNOWFLAKE_CONNECTOR_DB.RAW TO ROLE GLUE_SNOWFLAKE_CONNECTOR_ROLE;
GRANT CREATE TABLE ON SCHEMA GLUE_SNOWFLAKE_CONNECTOR_DB.RAW TO ROLE GLUE_SNOWFLAKE_CONNECTOR_ROLE;
GRANT USAGE ON WAREHOUSE DEMO_WH TO ROLE GLUE_SNOWFLAKE_CONNECTOR_ROLE;



GRANT SELECT ON ALL TABLES IN SCHEMA GLUE_SNOWFLAKE_CONNECTOR_DB.RAW TO ROLE SYSADMIN;
GRANT SELECT ON FUTURE TABLES IN SCHEMA GLUE_SNOWFLAKE_CONNECTOR_DB.RAW TO ROLE SYSADMIN;




